<!doctype html>
<html>
<head>
   <!--<script src ="task_manager.js"></script>-->
<meta charset="utf-8">
<title>To do List Manager</title>
    <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
<Link rel="stylesheet" type="text/css" href="design_for_task_manager.css">

</head>

<body>

<a href="external_form.html"> <span id="newTask" class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span></a>

<table id="table">
	<tr id="tableRow">
        <th id="tableId"> <button type="button" class="btn btn-default">Task Id</button> </th> 
  		<th id="tableDesc"> <button type="button" class="btn btn-default">Task Description</button> </th>
    	<th id="tablePrior"> <button type="button" class="btn btn-default">Task Priority </button></th>
    	<th id="tableDue"><button type="button" class="btn btn-default"> Due Date</button> </th>
    </tr>
    <tbody id="tbdy"></tbody>
</table> 

    
    <button type="button" class="btn btn-default" id="printTable"> Print Table</button>
    
    <script> 
    window.onload = loadTable;
        
        function loadTable(){
             localStorage.retrievedItems = JSON.stringify(retrievedItems); 
            removeTable();
            addingTable();
        }
 
    var tableB = document.getElementById("tbdy");
    var savedItems = localStorage.getItem("myTasks");
    var retrievedItems = JSON.parse(savedItems);
		
        
        function addingTable(){
		var table =document.getElementById("table");
			
            
           
            // alert(retrievedItems);
		for(i = 0 ; i < retrievedItems.length ; i++)
	{
		var addRow = document.createElement("tr");
		var addTask = document.createElement("td");
		var addDesc = document.createElement("td");
		var addPriority = document.createElement("td");
		var addDue = document.createElement("td");
		var tbdy = document.createElement("tbody");
		var addDeleteB = document.createElement("button");
		
		
		addTask.innerHTML = retrievedItems[i].uniqueNum;
		addDesc.innerHTML = retrievedItems[i].desc;
		addPriority.innerHTML = retrievedItems[i].priority;
		addDue.innerHTML = retrievedItems[i].due;
		addDeleteB.innerHTML = "Delete";
		
		addRow.appendChild(addTask);
		addRow.appendChild(addDesc);
		addRow.appendChild(addPriority);
		addRow.appendChild(addDue);
		addRow.appendChild(addDeleteB);
		
		tableB.appendChild(addRow);
		table.appendChild(tableB);
			
			
			addDeleteB.onclick = function()
		{
			
			
			var i= addDeleteB.parentNode.parentNode.rowIndex;
		    tableB.deleteRow(i);
			retrievedItems.splice(retrievedItems[i],1);
            localStorage.retrievedItems = JSON.stringify(retrievedItems);    
		}
	}
		
		
        }
		
		function removeTable(){
			tableB.innerHTML="";
			
		}
        
        
	document.getElementById("printTable").onclick = function(){
        removeTable();
        addingTable();
    }
	
	 document.getElementById("tableId").onclick = function()
 {
			retrievedItems.sort(function(a,b){
			
			var ageA=a.uniqueNum;
			var ageB=b.uniqueNum;
			
		return a.uniqueNum - b.uniqueNum;
			})
		removeTable();	
		addingTable();
		 localStorage.retrievedItems = JSON.stringify(retrievedItems); 

}

 document.getElementById("tableDue").onclick = function()
 {
			retrievedItems.sort(function(a,b){
			
			var dateA=a.due;
			var dateB=b.due;
			

			
		return a.due - b.due;
			})
		removeTable();	
		addingTable();
        localStorage.retrievedItems = JSON.stringify(retrievedItems); 
}

	//Description sort
	document.getElementById("tableDesc").onclick = function(){
			retrievedItems.sort(function(a,b)
			{
			
			var nameA=a.desc.toLowerCase();
			var nameB=b.desc.toLowerCase();
			
			if(nameA < nameB)
			{
				return -1;
			}
			
			if(nameA > nameB)
			{
				return 1;
			}
			
			else{
				return 0;
			}
			})
			removeTable();
			addingTable();
            localStorage.retrievedItems = JSON.stringify(retrievedItems); 
			}
			
			//priority sort
			document.getElementById("tablePrior").onclick = function(){
			
			retrievedItems.sort(function(a,b){
			
			var prioA=a.priority;
			var prioB=b.priority;
			
		return a.priority - b.priority;
			})
		removeTable();	
		addingTable();
        localStorage.retrievedItems = JSON.stringify(retrievedItems); 

}

    
    
    
    
    
    </script>
</body>
</html>
